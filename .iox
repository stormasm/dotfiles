
##
#  Iox ENV
##

export AWS_ACCESS_KEY_ID="minioadmin"
export AWS_SECRET_ACCESS_KEY="minioadmin"
export AWS_ENDPOINT="http://localhost:9000"

#export IOX_DBNAME='bananas'
export IOX_DBNAME='iox_shared'
export INFLUXDB_IOX_CATALOG_DSN='postgresql:///iox_shared'
export INFLUXDB_IOX_DB_DIR='/Users/ma/j/tmp22/iox_datadir'
export INFLUXDB_IOX_PERSIST_PARTITION_COLD_THRESHOLD_SECONDS='30'

export TEST_INTEGRATION=1
export TEST_INFLUXDB_IOX_CATALOG_DSN='postgresql:///iox_test'
export TEST_INFLUXDB_IOX_DB_DIR='/Users/ma/j/tmp22/iox_datatest'

### Iox Router
## export INFLUXDB_IOX_WRITE_BUFFER_TYPE='file'
## export INFLUXDB_IOX_WRITE_BUFFER_ADDR='127.0.0.1:8081'

export ARROW_TEST_DATA=/Users/ma/j/tmp06/arrow-testing/data
export PARQUET_TEST_DATA=/Users/ma/j/tmp06/parquet-testing/data

alias ckdir='env | grep TMPDIR'
alias tdir='export TMPDIR="/Users/ma/j/tmp33/iox01"'
alias ioxtmp='cd /Users/ma/j/tmp06/ioxtmp'
alias ioxtmpg='cd /Users/ma/j/tmp33'
alias ioxcc='ioxtmp; rm -fr iox01; mkdir iox01'

##
#  Iox
##

alias ioxg='cd ~/j/tmp06/influxdb_iox'
alias ioxgs='cd ~/j/tmp06/iox_sql_v00'
alias ioxioxs='cd ~/j/tmp06/iox_sql_v00/influxdb_iox/src/commands/sql'
alias ioxsqlg='cd ~/j/tmp06/iox_sql_v00/influxdb_iox/src/commands/sql'

alias iox='ioxg; ./target/debug/influxdb_iox'
alias ioxs='ioxgs; ./target/debug/influxdb_iox sql'

###
#   Iox Wal Directory
###

alias tiox='cd /tmp/iox'
alias tmpiox='cd /tmp/iox'
alias ioxd='cd ~/j/tmp22/iox_datadir'

####
#     Iox run
####

alias ioxja='ioxg; INFLUXDB_IOX_RPC_MODE=2 ./target/debug/influxdb_iox run ingester2 --api-bind=127.0.0.1:8081 --grpc-bind=127.0.0.1:8042 --wal-directory /tmp/iox/wal  --catalog-dsn postgres:///iox_shared --object-store=file --data-dir=/tmp/iox/obj -v'
alias ioxjb='ioxg; INFLUXDB_IOX_RPC_MODE=2 ./target/debug/influxdb_iox run router2 --api-bind=127.0.0.1:8080 --grpc-bind=127.0.0.1:8085 --ingester-addresses=127.0.0.1:8042 --catalog-dsn postgres:///iox_shared -v'
alias ioxjc='ioxg; INFLUXDB_IOX_RPC_MODE=2 ./target/debug/influxdb_iox run compactor2 --api-bind 127.0.0.1:8084 --grpc-bind 127.0.0.1:8088 --catalog-dsn postgres:///iox_shared --object-store=file --data-dir=/tmp/iox/obj -v'
alias ioxjd='ioxg; INFLUXDB_IOX_RPC_MODE=2 ./target/debug/influxdb_iox run querier --api-bind 127.0.0.1:8083 --grpc-bind 127.0.0.1:8082 --ingester-addresses=http://127.0.0.1:8042 --catalog-dsn postgres:///iox_shared --object-store=file --data-dir=/tmp/iox/obj -v'

alias irr='iox run router --write-buffer 'file' --write-buffer-addr '/Users/ma/j/tmp22/iox_datadir' -vv'

### Iox with logging, note the run all-in-one is needed for logging to work

alias ioxinfo='iox run all-in-one --log-filter info'

alias ioxaws='cargo run --features aws -- run all-in-one --object-store s3 --aws-endpoint http://localhost:9000 --bucket lowcard --aws-allow-http --log-filter debug,compactor=error'

alias ioxdbg='iox run all-in-one --log-filter debug,compactor=error'
alias ioxdebug='iox run all-in-one --log-filter debug'

alias ioxdbgcr='ioxg; cr run all-in-one --log-filter debug'

alias ioxdbgno='iox run all-in-one --log-filter debug,sqlx::query=error'
alias ioxdebugnoh2='iox run all-in-one --log-filter debug,hyper::proto::h1=info,h2=info'

alias ioxsql='iox sql'

alias gpiox='git pull https://github.com/influxdata/influxdb_iox main'

alias psqliox='psql postgres:///iox_shared'

### start iox with --data-dir

alias iox22='ioxg; ./target/debug/influxdb_iox --data-dir /Users/ma/j/tmp22/iox_datadir'
alias iox22a='iox --data-dir /Users/ma/j/tmp22/iox_datadir'
alias iox22b='iox --data-dir /Users/ma/j/tmp22/iox_datadir --persist-partition-age-threshold-seconds 10 --persist-partition-cold-threshold-seconds 10'
alias iox22c='iox --data-dir /Users/ma/j/tmp22/iox_datadir --persist-memory-threshold-bytes 100'

alias ioxmem='ioxg; ./target/debug/influxdb_iox run all-in-one'
alias ioxdb='ioxg; ./target/debug/influxdb_iox run all-in-one --catalog-dsn postgres:///iox_shared --data-dir=~/iox_data'
alias ioxrun='ioxg; ./target/debug/influxdb_iox run all-in-one --catalog-dsn postgres:///iox_shared --data-dir=~/iox_data'

### bring up iox uses HARDCODED binary
alias ioxa='iox --catalog-dsn postgres:///iox_shared --data-dir=/Users/ma/j/tmp06/iox_data'

### write data out to iox uses HARDCODED binary
alias ioxwmetrics='ioxg; iox write postgresql:///iox_shared ./test_fixtures/lineproto/metrics.lp --host http://localhost:8080'
alias ioxwmetricsplums='ioxg; iox write plums ./test_fixtures/lineproto/metrics.lp --host http://localhost:8080'

alias ioxmetrics='ioxg; cargo run -- write postgresql:///iox_shared ./test_fixtures/lineproto/metrics.lp --host http://localhost:8080'
alias ioxmetricsplums='ioxg; cargo run -- write plums ./test_fixtures/lineproto/metrics.lp --host http://localhost:8080'

alias ioxwtemp='ioxg; iox write postgresql:///iox_shared ./test_fixtures/lineproto/temperature.lp --host http://localhost:8080'
alias ioxwtemplums='ioxg; iox write plums ./test_fixtures/lineproto/temperature.lp --host http://localhost:8080'

### health check to make sure its up and running
alias ioxchk='curl localhost:8080/health'
alias ioxt='curl localhost:8080/health'

### run all tests
alias ctiox='ioxg; RUST_MIN_STACK=10485760 cargo test --all'

### print iox help
alias ioxh='ioxg; ./target/debug/influxdb_iox --help'
alias ioxhelp='ioxg; ./target/debug/influxdb_iox --help'

### database notes

alias dbn='cd ~/j/tmp06/dbnotes'
alias ioxn='cd ~/j/tmp06/ioxnotes'

### iox crates

alias ioxcat='ioxg; cd iox_catalog'

alias ioxcompact='ioxg; cd compactor'
alias ioxdg='ioxg; cd iox_data_generator'
alias ioxioxt='ioxg; cd influxdb_iox/tests/end_to_end_cases'
alias ioxing='ioxg; cd ingester'
alias ioxing2='ioxg; cd ingester2'
alias ioxiox='ioxg; cd influxdb_iox'
alias ioxioxa='ioxg; cd influxdb_iox/src/commands/run'
alias ioxioxg='ioxg; cd influxdb_iox/src/commands/run'
alias ioxpar='ioxg; cd parquet_file'
alias ioxquerier='ioxg; cd querier'
alias ioxquery='ioxg; cd iox_query'
alias ioxread='ioxg; cd read_buffer'
alias ioxqt='ioxg; cd query_tests'
alias ioxth='ioxg; cd test_helpers_end_to_end'
alias ioxwb='ioxg; cd write_buffer'

alias ioxc='ioxg; cd influxdb_iox_client/src'
alias ioxcli='ioxg; cd influxdb_iox_client/src/client'
alias ioxcme='cd ~/j/tmp06/influxdb_iox_client/influxdb_iox_client'

### iox commands

alias ioxdbga='iox debug namespace list'
alias ioxdbgb='iox debug schema get postgresql:///iox_shared'
alias ioxdbgplums='iox debug schema get plums'

##
#  Iox Nu
##

alias ioxnug='cd ~/j/tmp10/ioxnu'
alias nuruniox='ioxg; ./target/debug/nu'

##
#  Sqlite
##
alias sqlg='06; cd sqlite'

##
#  Sqlx
##
alias sqlxg='06; cd sqlx'

alias ioxdbcreate='DATABASE_URL=postgres:///iox_shared sqlx database create'
alias ioxdbstart='ioxg; cargo run -q -- catalog setup; cargo run -- catalog topic update iox-shared'

alias dbon='export DATABASE_URL="postgres:///todos"'
alias dboff='unset DATABASE_URL'
alias dbchk='export | grep DATABASE_URL'

##
#  Kafka
##
alias zoo='zookeeper-server-start /usr/local/etc/kafka/zookeeper.properties'
alias kafka='kafka-server-start /usr/local/etc/kafka/server.properties'

alias zoostop='zookeeper-server-stop /usr/local/etc/kafka/zookeeper.properties'
alias kafkastop='kafka-server-stop /usr/local/etc/kafka/server.properties'

alias rsk='06; cd rskafka'
alias tk0='rsk; TEST_INTEGRATION=1 TEST_BROKER_IMPL=kafka KAFKA_CONNECT=localhost:9092 cargo test'
alias tk1='rsk; TEST_INTEGRATION=1 TEST_BROKER_IMPL=kafka KAFKA_CONNECT=localhost:9092 cargo test test_topic_crud'

##
#  Kafka Homebrew
##
alias kl='cd /usr/local/var/lib'
alias kb='cd /usr/local/Cellar/kafka/3.2.1/bin'
alias kc='cd /usr/local/Cellar/kafka/3.2.1/bin'

##
#  Kafka Topics
##
alias ktc1='kafka-topics --create --topic iris --bootstrap-server localhost:9092'
alias ktdes='kafka-topics --bootstrap-server=localhost:9092 --describe --topic iris'
alias ktl='kafka-topics --bootstrap-server=localhost:9092 --list'
alias ktd='kafka-topics --bootstrap-server=localhost:9092 --delete --topic iris'

##
#  Kafka Pub / Sub
##
alias kcp='kafka-console-producer --topic iris --bootstrap-server localhost:9092'
alias kcc='kafka-console-consumer --topic iris --from-beginning --bootstrap-server localhost:9092'

##
#  Redpanda
##
alias dcu='docker compose up'
alias rpkstart='rpk container start'
alias rpkstop='rpk container stop'
alias rpkpurge='rpk container purge'

##
#  low_card
##

alias lc='cd ~/j/tmp06/low_card'
alias lowcard='cd ~/j/tmp06/low_card'

##
#  arrow and data fusion
##

alias getdf='gc git@github.com:apache/arrow-datafusion.git'
alias dfg='cd ~/j/tmp06/arrow-datafusion/datafusion'
alias dfgt='cd ~/j/tmp06/arrow-datafusion'
alias dfgo='cd ~/j/tmp06/arrow-datafusion'

alias dfgc='cd ~/j/tmp06/arrow-datafusion/datafusion-cli/src'
alias dfgcl='cd ~/j/tmp06/arrow-datafusion/datafusion-cli/src'
alias dfgcli='cd ~/j/tmp06/arrow-datafusion/datafusion-cli/src'
alias dfclig='cd ~/j/tmp06/arrow-datafusion/datafusion-cli/src'

alias dfcore='dfgt; cd datafusion/core/src'
alias dfexpr='dfgt; cd datafusion/expr/src'
alias dfopt='dfgt; cd datafusion/optimizer/src'
alias dfpe='dfgt; cd datafusion/physical-expr/src'
alias dfex='dfgt; cd datafusion-examples/examples'

alias gpar='git pull https://github.com/apache/arrow-rs master'
alias gparr='git pull https://github.com/apache/arrow-rs master'
alias gpdf='git pull https://github.com/apache/arrow-datafusion master'

##
#  minio
##

alias miniostart='ioxd; minio server ./data &'

##
#  parquet to line protocol PR 5734 for more details
#
#  ioxpartolp [parquet filename]
##
alias ioxpartolp='iox debug parquet-to-lp'

##
#  datafusion
##
alias dcl='/Users/ma/j/tmp06/arrow-datafusion/datafusion-cli/target/debug/datafusion-cli'
alias dcli='/Users/ma/j/tmp06/arrow-datafusion/datafusion-cli/target/debug/datafusion-cli'
alias dfc='/Users/ma/j/tmp06/arrow-datafusion/datafusion-cli/target/debug/datafusion-cli'
alias dfcl='/Users/ma/j/tmp06/arrow-datafusion/datafusion-cli/target/debug/datafusion-cli'
alias dfcli='/Users/ma/j/tmp06/arrow-datafusion/datafusion-cli/target/debug/datafusion-cli'
alias ctpp='cnr physical_plan::'

##
#  GlueSql
##

alias gg='cd ~/j/tmp06/GlueSql/core/src'
alias ggt='cd ~/j/tmp06/GlueSql'
alias gsg='cd ~/j/tmp06/GlueSql'
alias gpglue='git pull https://github.com/gluesql/gluesql main'
alias gsp='cd ~/j/tmp06/sqlparser-rs'

##
#  Schnappslatte
##
alias slg='cd ~/j/tmp06/schnapslatte/src'
alias slgt='cd ~/j/tmp06/schnapslatte'
alias slr='cargo run -- --listen-ip=127.0.0.1 --leader-hostname=127.0.0.1 --advertise-hostname=127.0.0.1 --port=3033'
alias slrex='cargo run --example ex00 -- --listen-ip=127.0.0.1 --leader-hostname=127.0.0.1 --advertise-hostname=127.0.0.1 --port=3033'

alias sl='cd ~/j/tmp06/sl/flight/src'
alias slex='cd ~/j/tmp06/sl/examples'
